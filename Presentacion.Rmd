---
title: "Modelos de TRI para<br>cuestionarios de elección forzosa"
author: "Daniel Morillo"
date: "`r format(lubridate::today(), '%d de %B de %Y')`"
output:
  ioslides_presentation:
    css: res/styles.css
    fig_width: 5
    fig_height: 4.5
    incremental: true
    logo: res/LOGO_UAM_NEGRO_VARIANTE.JPG
    theme: simplex
    transition: slower
    widescreen: true
runtime: shiny
bibliography: "res/dissertation_bibliography.bib"
csl: "res/apa-old-doi-prefix.csl"
editor_options:
  chunk_output_type: console
---


```{r setup, include=FALSE}

library(tidyverse)
library(magrittr)
library(knitr)
library(shiny)

"R/Rmarkdown_code.R" %>% source(encoding = 'UTF-8')

opts_chunk$set(
  cache = TRUE, results = 'asis',
  message = FALSE, warning = FALSE, echo = FALSE
)

init_ggplot()

"R/Presentacion.R" %>% readLines(encoding = 'UTF-8') %>% read_chunk(lines = .)

```


---

<center>
<br>

### <b>

### Modelos de TRI para cuestionarios de elección forzosa

### </b>

<br>

#### Tesis doctoral enviada para la obtención del título de<br>Doctor en Psicología Clínica y de la Salud

<br>

##### Por: Daniel Morillo

###### Supervisores: Francisco José Abad, Iwin Leenen
###### Tutor: Vicente Ponsoda

</center>

<div class="notes">

Buenos días.
Ante todo quisiera a gradecer a los miembros del tribunal que hayan aceptado
evaluar el trabajo de mi tesis y estar hoy presentes para emitir su juicio
experto sobre ella, y a todas las personas presentes por estar aquí y darme la
oportunidad de exponer públicamente los resultados de mi investigación
predoctoral.

</div>

# Introducción:<br>El formato de elección Forzosa y los modelos de TRI


## El formato de Elección Forzosa

- Formato de respuesta para cuestionarios

- Evaluación no cognitiva

- Control de los sesgos de respuesta

- Aumento de validez


## El formato de Elección Forzosa multidimensional

- Agrupamiento de indicadores de distintas dimensiones

- Medición simultánea de varios constructos

- Puntuaciones ipsativas


## Ipsatividad

<!-- TODO: Referencias -->

- Puntuaciones intra-persona

- Estructura factorial distorsionada

- Fiabilidad reducida

- Validez predictiva reducida

- No comparables entre personas


## Aplicación de la Teoría de Respuesta al Ítem

- Modelo "Multi-Unidimensional Pairwise Preference" [@stark_irt_2005]

- Modelo "TRI Thurstoniana" [@brown_item_2011]


## Justificación: Propuesta del modelo MUPP-2PL

- Simplificación del modelo MUPP

- Variante tipo _dominancia_: logístico de 2 parámetros [@birnbaum_latent_1968]

- Abordaje teórico

- Propuesta de método de estimación


<div class="notes">

Modelos de dominancia se consideran más apropiados para ítems de personalidad (en general)

Modelo más parsimonioso, y más sencillo de abordar teóricamente

</div>


## Estructura

- Estudio 1: Variante de dominancia dentro del marco MUPP: formulación y estimación mediante Markov Chain-Monte Carlo

- Estudio 2: Evaluación y mitigación de problemas pscométricos en el diseño de
cuestionarios de elección forzosa multidimensionales para selección de personal

- Estudio 3: Comprobación del supuesto de invarianza del modelo MUPP-2PL

- Conclusiones


# Estudio 1:<br>Variante de dominancia dentro del marco MUPP: formulación y estimación Markov Chain-Monte Carlo


## Objetivos

- Propuesta teórica del modelo

- Propuesta de algoritmo Markov Chain-Monte Carlo (estimación Bayesiana conjunta)

- Comparar con estimación factorial

- Poner a prueba estimación con datos empíricos


<div class="notes">

El objetivo del estudio 1 es estudiar las propiedades teóricas del modelo, así como
la estimación del mismo mediante el método Bayesiano propuesto.
Se han utilizado para ello diferentes condiciones consideradas más, o menos favorables,
en función de las propiedades teóricas del modelo y de consideraciones aportadas por la
literatura previa.

Asimismo, como existe una equivalencia práctica entre el modelo MUPP-2PL
y el modelo TIRT, esto nos permite comparar los dos métodos de estimación, el
Bayesiano, basado en información completa, y el método frecuentista, basado en
Análisis Factorial Confirmatorio de la información bivariada.

Estudio de simulación para comprobar las condiciones (sobre todo las
supuestamente desfavorables)

</div>


## Modelo MUPP-2PL

Supuesto de independencia MUPP [@stark_irt_2005]:

<br>

<center>
$$
\textrm{P}_i \left(Y_{ij} = 1 \right) = \frac{\textrm{P}_i \left(X_{i_1j} = 1 \right) \textrm{P}_i \left(X_{i_2j} = 0 \right)}{\textrm{P}_i \left(X_{i_1j} = 1 \right) \textrm{P}_i \left(X_{i_2j} = 0 \right) + \textrm{P}_i \left(X_{i_1j} = 0 \right) \textrm{P}_i \left(X_{i_2j} = 1 \right)}
$$
</center>


## Modelo MUPP-2PL

Supuesto de medida: 2PL [@birnbaum_latent_1968]

<div class="columns-2">

<br>

$$
\textrm{P}_i \left(X_{ij} = 1 | \theta_j \right) = \Phi_L \left(a_i\theta_j + b_i \right)
$$
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>

```{r 2PL, fig.width=5, fig.height=4.5}

theta_vector <- seq(-3, 3, 0.1)

probs <- irf_2PL(theta_vector, 1.8, 0)

irf <- tibble(
  theta = theta_vector,
  prob  = probs,
  lab   = paste0(
    "P<sub>i</sub>(", theta %>% format(digits = 1), ") = ", prob %>% round(3)
  )
)

irf_plot <- irf %>% ggplot(
  mapping = aes(x = theta, y = prob, text = lab, group = NA)
) + geom_path(color = "darkblue", size = 1) +
  ggtitle("Curva característica del ítem") +
  scale_x_continuous(expand = expand_scale()) +
  scale_y_continuous(expand = expand_scale(.01))

irf_plot %>% ggplotly(tooltip = "text") %>%
  layout(
    xaxis = list(title = TeX("\\textrm{P}_i \\left(X_{ij} = 1 | \\theta_j \\right)")),
    yaxis = list(title = TeX("\\theta_j"))
  ) %>% plotly_conf

```

</div>


## Modelo MUPP-2PL

$$
\textrm{P}_i\left(Y_{ij} = 1 | {\bf \unicode[Times]{x3B8}}\right) = \Phi_L\left(a_{i_1}\theta_{\tilde{i_1}j} - a_{i_2}\theta_{\tilde{i_2}j} + l_i\right)
$$

```{r MUPP_2PL_BRF_vector_applet, cache=FALSE}

INIT_BLOCK <- tibble(
  a1 = 1, a2 = 1, l = 0, pol1 = "+", pol2 = "+", dim1 = "theta_1", dim2 = "theta_2"
)
DEFAULT_POV <- c(x = -.3, y = -2.25, z = 1.25)

block <- reactive(
  {
    tibble(
      a1 = input$a1_adjust, a2 = input$a2_adjust, l = input$l_adjust,
      pol1 = input$item_1_polarity, pol2 = input$item_2_polarity,
      dim1 = input$item_1_dim, dim2 = input$item_2_dim
    )
  }
)

pov <- reactive(
  {
    DEFAULT_POV
  }
)
# block %>% plot_MUPP_2PL_brf
# block %>% plot_MUPP_2PL_vectors(cor = 0)

fluidRow(
  column(4, plotlyOutput(outputId = "MUPP_2PL_brf_view")),
  column(4, plotOutput(outputId = "MUPP_2PL_vector_view")),
  column(
    4,
    br(),
    br(),
    fluidRow(
      column(
        6, align = "center",
        sliderInput(
          "a1_adjust", label = HTML("<em>a<sub>i</sub></em><sub>1</sub>"), 0, 2,
          value = INIT_BLOCK$a2, step = 0.1
        )
      ),
      column(
        3,
        radioButtons(
          "item_1_polarity", label = "Polaridad:", selected = INIT_BLOCK$pol1,
          choiceNames = c("+", "-"), choiceValues = c("+", "-")
        )
      ),
      column(
        3,
        radioButtons(
          "item_1_dim", label = "Dimensión:", selected = INIT_BLOCK$dim1,
          choiceNames = c("1", "2"),
          choiceValues = c("theta_1", "theta_2")
        )
      )
    ),
    fluidRow(
      column(
        6, align = "center",
        sliderInput(
          "a2_adjust", label = HTML("<em>a<sub>i</sub></em><sub>2</sub>"), 0, 2,
          value = INIT_BLOCK$a2, step = 0.1
        )
      ),
      column(
        3,
        radioButtons(
          "item_2_polarity", label = HTML("&nbsp;"), selected = INIT_BLOCK$pol2,
          choiceNames = c("+", "-"), choiceValues = c("+", "-")
        )
      ),
      column(
        3,
        radioButtons(
          "item_2_dim", label = HTML("&nbsp;"), selected = INIT_BLOCK$dim2,
          choiceNames = c("1", "2"),
          choiceValues = c("theta_1", "theta_2")
        )
      )
    ),
    fluidRow(
      align = "center",
      sliderInput(
        "l_adjust", label = HTML("<em>l<sub>i</sub></em>"), -2, 2,
        value = INIT_BLOCK$l, step = 0.1, width = "90%"
      )
    )
  )
)

output$MUPP_2PL_brf_view <- renderPlotly(
  block() %>% plot_MUPP_2PL_brf(pov = pov())
)
output$MUPP_2PL_vector_view <- renderPlot(
  block() %>% plot_MUPP_2PL_vectors(cor = 0)
)

```


<div class = "notes">

Algebraicamente equivalence a un modelo logístico multidimensional compensatorio

Bloques heteropolares / homopolares

Bloques unidimensionales

Si los dos ítems del bloque miden el mismo rasgo latente, se reduce nuevamente
a un modelo logístico de 2 parámetros, con una indeterminación adicional que
afecta a los parámetros de escala.

</div>


## Estimación Bayesiana

- Algoritmo Markov Chain-Monte Carlo: muestreo Metropolis-within-Gibbs

- Información completa (vs. bivariada)

- Estimación conjunta

- Estadísticos "Expected a Posteriori"


<div class="notes">

Previsiblemente, información completa mejor recuperación del espacio latente.

Estimación conjunta, mayor precisión en la estimación de la incertidumbre de los
parámetros incidentales.

</div>


## Estudio de simulación: Recuperación de parámetros

### Diseño

- Estimación sin bloques unidimensionales
[@stark_irt_2005; @chernyshenko_normative_2009]

- Estimación con/sin bloques heteropolares [@brown_item_2011]

- Comparación con estimación CFA

```{r simulation_recovery_result_matrix}
```


<div class="notes">

Interés en poner a prueba la estimación en condiciones supuestamente
desfavorables.

Por un lado, se argumenta la necesidad de utilizar bloques unidimensionales para
identificar la métrica.
Puesto que no vemos la necesidad de hacerlo, y su aplicación práctica es
limitada, obviamos esta condición, en previsión de que serían innecesarios.

Por otro, la necesidad de incluir bloques heteropolares.
Ponemos a prueba diferentes condiciones para comprobar el efecto de incluir más
o menos bloques heteropolares, junto con otras condiciones típicamente
manipuladas: la correlación entre dimensiones del espacio latente, y la longitud
del cuestionario.

</div>


## Estudio de simulación: Recuperación de parámetros

<center>
Resultados: Parámetros de escala

```{r simulation_recovery_results_scales, fig.height=4, fig.width=8, dependson="simulation_recovery_result_matrix"}

scale_corr_plot <- study_1_results %>% filter(Parametro == "Escalas") %>%
  mutate(Nivel = Nivel %>% factor(levels = levels(.) %>% rev)) %>%
  rename(`Correlación` = Valor, `Proporción de bloques heteropolares` = Nivel) %>%
  ggplot(
    aes(
      `Proporción de bloques heteropolares`, `Correlación`,
      group = Algoritmo, color = Algoritmo
    )
  ) +
  geom_point() + geom_line() + ylim(0:1) +
  ggtitle("Escala verdadera - estimación")

scale_corr_plot %>% ggplotly(tooltip = c("y", "colour")) %>% plotly_conf

```
</center>


## Estudio de simulación: Recuperación de parámetros

<center>
Resultados: Parámetros de correlación

```{r simulation_recovery_results_correlations, fig.height=4, fig.width=8, dependson="simulation_recovery_result_matrix"}

corrs_RMSE_plot <- study_1_results %>% filter(Parametro == "Correlaciones") %>%
  mutate(Nivel = Nivel %>% factor(levels = levels(.) %>% rev)) %>%
  rename(RMSE = Valor, `Proporción de bloques heteropolares` = Nivel) %>%
  ggplot(
    aes(
      `Proporción de bloques heteropolares`, RMSE,
      group = Algoritmo, color = Algoritmo
    )
  ) +
  geom_point() + geom_line() + ylim(c(0, .1)) +
  ggtitle("Correlaciones entre dimensiones latentes")

corrs_RMSE_plot %>% ggplotly(tooltip = c("y", "colour")) %>% plotly_conf

```
</center>


## Estudio de simulación: Recuperación de parámetros

<center>
Resultados: Rasgo latente (precisión)

```{r simulation_recovery_results_lt_prec, fig.height=4, fig.width=8, dependson="simulation_recovery_result_matrix"}

lt_rel_plots <- study_1_results %>%
  filter(Parametro == "Rasgo latente", Variable == "OPBP") %>%
  mutate(Nivel = Nivel %>% factor(levels = levels(.) %>% rev)) %>%
  rename(`Proporción de bloques heteropolares` = Nivel) %>%
  ggplot(
    aes(
      `Proporción de bloques heteropolares`, Valor,
      group = Algoritmo, color = Algoritmo
    )
  ) + facet_grid(cols = vars(Estadistico), scales = "free", space = "free") +
  geom_point(alpha = .5) + geom_line(alpha = .5) + ylab("") + ylim(0:1) +
  ggtitle("Niveles de rasgo latente")

lt_rel_plots %>% ggplotly(tooltip = c("y", "colour")) %>% plotly_conf

```
</center>


## Estudio de simulación: Recuperación de parámetros

<center>
Resultados: Rasgo latente (incertidumbre)

```{r simulation_recovery_results_lt_CrI, fig.height=4, fig.width=8, dependson="simulation_recovery_result_matrix"}

lt_CrI_plots <- study_1_results %>%
  filter(Parametro == "Rasgo latente", Variable == "QL") %>%
  mutate(Valor = Valor * 100) %>%
  rename(`Longitud cuestionario (nº ítems)` = Nivel) %>%
  ggplot(
    aes(
      `Longitud cuestionario (nº ítems)`, Valor,
      group = Algoritmo, color = Algoritmo
    )
  ) + geom_point(alpha = .5) + geom_line(alpha = .75) + ylim(c(90, 100)) +
  ylab("% cobertura del parámetro verdadero") +
  ggtitle("Intervalo de credibilidad del rasgo latente")
  

lt_CrI_plots %>% ggplotly(tooltip = c("y", "colour")) %>% plotly_conf

```
</center>


## Estudio empírico

- Estimación de modelo "Big Five"

- Algoritmo MCMC y CFA

- Estimaciones menos extremas:
    - En parámetros de escala de algunos ítems
    
    - En correlaciones del espacio latente
    
- Fiabilidades mayores


## Estudio 1: Conclusiones

Modelo MUPP-2PL:

- Equivalencia con TIRT

- Indeterminación de parámetros de posición

- Estimable sin bloques unidimensionales

- Estimable sin bloques heteropolares


## Estudio 1: Conclusiones

Estimación Bayesiana:

- Permite estimación conjunta

- Buena recuperación con nº bajo de dimensiones

- Generalización al modelo MUPP


## Estudio 1: Conclusiones

Comparación con CFA:

- Fiabilidades mayores

- Mejor estimación de incertidumbre en parámetros de rasgo latente

- Mayor precisión en correlaciones del espacio latente

- Estimaciones más razonables con escasez de información


## Estudio 1: Limitaciones

- Modelo MUPP-2PL:

    - Sólo 2 ítems


- Estimación Bayesiana:

    - Estadísticos de ajuste

    - Intensidad computacional

    - Menor facilidad de uso


# Estudio 2:<br>Evaluación y mitigación de problemas pscométricos en el diseño de cuestionarios de elección forzosa multidimensionales para selección de personal


## Objetivos

- Estudiar las propiedades teóricas de QEFs robustos a los sesgos de respuesta

- Estudiar la estimación del modelo MUPP-2PL en condiciones de restricción
dimensional

- Proponer y evaluar indicadores de calidad para evaluar la calidad en
condiciones de restricción dimensional


## QEF para selección de personal

- Sensibilidad a sesgos de respuesta:

    - Ítems inversos
    
    - Bloques unidimensionales

- Diseño de "pares bidimensionales directos" (DBP)


## Indeterminación empírica del diseño DBP

<center>
```{r MUPP_2PL_empirical_underdetermination, cache=FALSE}

N_BLOCKS <- 18
CORR_INIT <- 0
LOCATION_PARAMS <- rnorm(N_BLOCKS, 0, .5)

fluidRow(
  column(
    6,
    plotOutput(
      outputId = "MUPP_2PL_vectors_underidentification", height = "500px"
    )
  ),
  column(
    6, align = "center", br(), br(), br(), br(),
    sliderInput(
      "corr_adjust", label = HTML("Correlación entre escalas:"), -.75, .95,
      value = CORR_INIT, step = 0.05
    )
  )
)


eui_blocks <- reactive(
  {
    scales <- rbvlnorm(
      N_BLOCKS, location = c(.25, .25),
      bvlnorm.scale(c(.25, .25), input$corr_adjust)
    )
    
    tibble(
      a1 = scales[, 1], a2 = scales[, 2], l = LOCATION_PARAMS,
      pol1 = "+", pol2 = "+", dim1 = "theta_1", dim2 = "theta_2"
    )
  }
)

output$MUPP_2PL_vectors_underidentification <- renderPlot(
  eui_blocks() %>% plot_MUPP_2PL_vectors(cor = 0, alpha = .75, thickness = 1)
  # res = 300
)

```
</center>


<!-- ## Indeterminación empírica del diseño DBP -->

<!-- - Matriz de información -->

<!-- [Imagen scatter plot rasgos simulados y estimados] -->


## Restricción dimensional del diseño DBP

- Reducción de fiabilidad
    
- Distorsión de correlaciones
    
- Ipsatividad


## Evaluación de la sensibilidad dimensional

```{r load_LEV_LSV_sims}
```

### Menor valor singular (*LSV*)

<center>
```{r plot_LSV_sims, dependson="load_LEV_LSV_sims", fig.width=9}

plot_LSV <- results %>%
  ggplot(
    aes(
      `Correlación entre escalas`, LSV,
      group = `Nº dimensiones`, color = `Nº dimensiones`,
      text = HTML("<i>LSV</i>:") %>% paste(LSV %>% round(3))
    )
  ) +
  facet_grid(cols = vars(items.dim)) + geom_point() + geom_line() +
  scale_color_manual(values = PALETTE.COLORS %>% unname) +
  ylab(HTML("<i>LSV</i>"))

plot_LSV %>% ggplotly(tooltip = "text") %>%
  layout(margin = list(r = 140)) %>%
  config(displayModeBar = FALSE)

```
</center>


<!-- ## Evaluación de la sensibilidad dimensional -->

<!-- - Menor autovalor (*LEV*) -->

<!-- [Imagen diferente correlación entre dimensiones (figura 3.2)] -->


## Evaluación de la sensibilidad dimensional

### Menor autovalor (*LEV*)

<center>
```{r plot_LEV_corr_0.0_sims, dependson="load_LEV_LSV_sims", fig.width=9}

results %>% plot_LEV(
  LEV_corr_0,
  LEV_max,
  "Suma de correlaciones = 0.0"
)
  
```
</center>


## Evaluación de la sensibilidad dimensional

### Menor autovalor (*LEV*)

<center>
```{r plot_LEV_corr_0.3_sims, dependson="load_LEV_LSV_sims", fig.width=9}

results %>% plot_LEV(
  LEV_corr_0.3,
  LEV_max,
  "Suma de correlaciones = 0.3"
)
  
```
</center>


## Evaluación de la sensibilidad dimensional

### Menor autovalor (*LEV*)

<center>
```{r plot_LEV_corr_0.6_sims, dependson="load_LEV_LSV_sims", fig.width=9}

results %>% plot_LEV(
  LEV_corr_0.6,
  LEV_max,
  "Suma de correlaciones = 0.6"
)
  
```
</center>


## Evaluación de la sensibilidad dimensional

### Menor autovalor (*LEV*)

<center>
```{r plot_LEV_corr_0.9_sims, dependson="load_LEV_LSV_sims", fig.width=9}

results %>% plot_LEV(
  LEV_corr_0.9,
  LEV_max,
  "Suma de correlaciones = 0.9"
)
  
```
</center>


## Estudio de simulación

- Evaluar la estimación de rasgos latentes en condiciones de restricción
dimensional

- Comprobar la capacidad predictiva de los indicadores de sensiblidad
dimensional


## Estudio de simulación

- Diseño:

    - Correlación entre parámetros de escala del bloque

    - Longitud del cuestionario

    - Correlación entre dimensiones del espacio latente


- Indicadores:

    - Fiabilidad y distorsión de correlaciones entre rasgos

    - *LSV* y *LEV*


## Estudio de simulación

Resultados: Fiabilidad empírica

[Gráfico de interacción BSC x LTC (figura 3.5)]


## Estudio de simulación

Resultados: Distorsión de correlaciones

[Gráficos NB, BSC, LTC]


## Estudio de simulación

Resultados: *LSV* y *LEV*

[Figuras 3.6 y 3.7]


## Estudio 2: Conclusiones

- Diseño DBP

- Indeterminación empírica del modelo MUPP-2PL

- Índices de sensibilidad dimensional

- Generalizabilidad de resultados


## Estudio 2: Limitaciones

- Validez externa

- Uso de los índices de sensibilidad dimensional

- Sensibilidad dimensional local


# Estudio 3:<br>Comprobación del supuesto de invarianza del modelo MUPP-2PL

```{r data_load, include=FALSE}
```

```{r data_formatting, include=FALSE, dependson="data_load"}
```

```{r unidimensionality_assessment, include=FALSE, dependson="data_formatting"}
```

```{r LR_tests, include=FALSE, dependson="unidimensionality_assessment"}
```

```{r all_stats_table, include=FALSE, dependson="LR_tests"}
```


## Objetivos

- Comprobar el supuesto de invarianza de los parámetros del modelo MUPP-2PL

- Explorar los factores que potencialmente influyen en la violación del supuesto


## Supuesto de invarianza

MUPP-2PL:

$$
\textrm{P}_i\left(Y_{ij} = 1 | {\bf \unicode[Times]{x3B8}}\right) = \Phi_L\left(a_{i_1}\theta_{\tilde{i_1}j} - a_{i_2}\theta_{\tilde{i_2}j} + l_i\right)
$$

Ítem 1:

$$
\textrm{P}_{i_1}\left(X_{i_1j} = 1 | \theta_\tilde{i_1}\right) = \Phi_L\left(a_{i_1}^*\left(\theta_{\tilde{i_1}j} - b_{i_1}\right)\right)
$$

Ítem 2:

$$
\textrm{P}_{i_2}\left(X_{i_2j} = 1 | \theta_\tilde{i_2}\right) = \Phi_L\left(a_{i_2}^*\left(\theta_{\tilde{i_2}j} - b_{i_2}\right)\right)
$$


## Supuesto de invarianza

<br>

<center>

- $a_{i_1}^*\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\longrightarrow a_{i_1}$

<br>

- $a_{i_2}^*\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\longrightarrow a_{i_2}$

<br>

- $a_{i_2}^*b_{i_2}-a_{i_1}^*b_{i_1}\longrightarrow l_i$

</center>


## Supuesto de invarianza

### Con ítems de escala graduada (i.e. Likert):

<!-- TODO: [imagen umbrales Likert] -->

$$a_{i_2}^*b_{i_2k'}-a_{i_1}^*b_{i_1k'}\longrightarrow l_i$$


## Prueba de invarianza

- Test razón de verosimilitud de modelos anidados (por parámetro)

<!-- TODO: [Imagen de modelos CFA con parámetros libres / restringidos] -->


- Estadístico: $SB-\chi^2$ robusto estrictamente positivo [@satorra_ensuring_2010]


<div class="notes">

Para calcular este estadístico y realizar el test de razón de verosimilitudes
es necesario estimación CFA (Mplus; no algoritmo MCMC)

</div>


## Prueba de invarianza

### Conjunto de datos:

- Test de personalidad "Big Five"

- Respuestas de 695 - 396 estudiantes

- Ítems Likert y bloques EF

- Emparejamiento de rasgos balanceado

- Bloques homopolares y heteropolares


## Resultados

<center>
### Parámetros de escala

```{r joint_scatter_plot_scales_per_item_trait, dependson="all_stats_table"}

scales.joint.collapsed %>% rename(`Block_code` = Block) %>%
  left_join(
    block.item.params.joint %>% select(`Block_code` = Block, Bloque)
  ) %>%
  mutate(Label = NI %>% if_else(Bloque, NA_character_)) %>%
  scales.scatter.plot(
    Trait, labels = Label,
    width = 6, height = 5.2, units = "in", dpi = "print"
  )

```
</center>


<div class="notes">

Se cumple el supuesto de invarianza en casi todos los casos, menos en dos
parámetros.

Esto imposibilita el estudio de la invarianza a nivel de ítems y bloques

A nivel de cuestionario:

"Compresión" del rango
Desplazamiento del origen

</div>


## Resultados

<center>
### Parámetros de posición

```{r joint_threshold_plot_per_block, dependson="all_stats_table", fig.width=9}

threshold_1 <- block.item.params.joint %>% plot_joint_threshold_per_block(
  `Intersección`, `Predicción umbral 1`
)
threshold_2 <- block.item.params.joint %>% plot_joint_threshold_per_block(
  `Intersección`, `Predicción umbral 2`
)
threshold_3 <- block.item.params.joint %>% plot_joint_threshold_per_block(
  `Intersección`, `Predicción umbral 3`
)
threshold_4 <- block.item.params.joint %>% plot_joint_threshold_per_block(
  `Intersección`, `Predicción umbral 4`
)

subplot(
  threshold_1, threshold_2, threshold_3, threshold_4,
  nrows = 1, shareX = TRUE, shareY = TRUE
)

```
</center>


- "Compresión" del rango

- "Desplazamiento" del origen


<div class="notes">

Más violaciones de invarianza con la segunda categoría.

Cuarta categoría la que menos.
Posible "desplazamiento" del origen: sesgo negativo en bloques, o posible
sesgo positivo (aquiescencia) en ítems, controlado por bloques

</div>


## Resultados

```{r intercepts_preprocessing, include=FALSE, dependson="all_stats_table", fig.width=9}
```


<center>
### Exploración de violación del supuesto (posición)


```{r non_invariant_intercepts_plot, dependson="intercepts_preprocessing", fig.width=9}

intercept.invariance.plot <- non.invariant.intercepts %>%
  ggplot(
    aes(Bloque, `Desviación intersección`, shape = `Rasgo 1`, color = `Rasgo 2`)
  ) +
  geom_point(size = 2.5) + scale_shape_manual(values = c(16, 17, 15, 18)) +
  scale_color_manual(values = PALETTE.COLORS %>% unname) +
  geom_hline(yintercept = 0) +
  facet_grid(
    `Threshold category` ~ `Polarity 2`,
    as.table = FALSE, scales = "free_x"
  ) +
  theme_minimal(base_family = "serif", base_size = 12) +
  ggtitle("Polaridad del bloque") +
  theme(plot.title = element_text(hjust = .5, size = 12))

# intercept.invariance.plot %>% ggsave(
#   filename = "non_invariant_intercepts_plot.png", plot = .,
#   width = 6.5, height = 8, units = "in", dpi = "print"
# )

intercept.invariance.plot %>% ggplotly %>% config(displayModeBar = FALSE)

```
</center>


<div class="notes">

Los rasgos medidos por cada ítem pueden jugar un papel en la violación
de la invarianza: más violaciones en Neuroticismo (en segunda posición) y
Apertura (primera pos)

Polaridades no parecen afectar (pero su efecto no puede separarse entre
polaridad del ítem, y bloque, debido al diseño de bloques heteropolares)

Patrón consistente para diferentes polaridades de ítems y rasgos

</div>


## Resultados

<center>
### Exploración de violación del supuesto (posición)


```{r non_invariant_intercepts_plot_4th_threshold, dependson="intercepts_preprocessing", fig.width=9}

intercept.invariance.plot.threshold.4 <- non.invariant.intercepts %>%
  filter(`Threshold category` == "Umbral 4") %>%
  ggplot(
    aes(Bloque, `Desviación intersección`, shape = `Rasgo 1`, color = `Rasgo 2`)
  ) +
  geom_point(size = 2.5) + scale_shape_manual(values = c(16, 17, 15, 18)) +
  scale_color_manual(values = PALETTE.COLORS %>% unname) +
  geom_hline(yintercept = 0) +
  facet_grid(. ~ `Polarity 2`, as.table = FALSE, scales = "free_x"
  ) +
  theme_minimal(base_family = "serif", base_size = 12) +
  ggtitle("Polaridad del bloque") +
  theme(plot.title = element_text(hjust = .5, size = 12))

intercept.invariance.plot.threshold.4 %>% ggplotly %>%
  config(displayModeBar = FALSE)

```
</center>


<div class="notes">

Asumiendo que se da el efecto de escalamiento y desplazamiento del origen,
podemos centrarnos en la categoría 4, asumiendo que sus predicciones son más
precisas: por un lado, tenemos el menor número de violaciones de la invarianza,
y por otro, los errores de predicción positivos y negativos están igualmente
distribuidos, al contrario que en otras categorías.

En estas condiciones, podemos interpretar las violaciones de la
invarianza como violacions del supuesto de independencia a su vez, posiblemente
debido a una interacción de efectos entre rasgo y polaridad.
(Es decir, combinar determinados ítems con rasgos y polaridades específicas
podría afectar a la invarianza)

El signo del error de predicción está asociado con la polaridad y el rasgo
medido.

</div>


## Conclusiones

- Metodología para poner a prueba el supuesto del modelo MUPP-2PL

- Cumplimiento general del supuesto de invarianza

- Consideraciones sobre las violaciones de la invarianza

    - Efecto de escalamiento
    
    - Efecto de desplazamiento de la posición
    
    - Violaciones de invarianza a nivel de bloque


<div class="notes">

El cumplimiento del supuesto de invarianza permite contruir QEFs basándose
en las propiedades de ítems Likert precalibrados
(Reducción de costes, optimización de criterios)

Violaciones de invarianza pueden afectar a la información:

Efecto de escalamiento reduciría la información del QEF (pero predecible)

Umbral usado para la estimación; por otro lado, modelos que puedan dar cuenta
de este efecto (e.g. sesgo de aquiescencia en los ítems)

Hipótesis a comprobar sobre los bloques, mediante ítems/bloques experimentales
diseñados para inducir o mitigar las violaciones de invarianza

</div>


## Limitaciones

- Manipulación experimental de fuentes de violación de la invarianza

- Estimación con bloques con *Extraversión*


# General conclusions


<div class="notes">

We have discussed the three studies separately. Now we will discuss some
conclusions fro the results of the three studies and the relationships among
them.

</div>


---

> 1 - A variant of the MUPP model [@stark_irt_2005] under a dominance
measurement assumption can be formulated and identified; it has been called the
MUPP-2PL model.

<br>

> 2 - When data represents responses to a multidimensional pairwise FC
questionnaire, both the MUPP-2PL and the TIRT model [@brown_item_2011] can be
applied. Under these conditions, the two models are quasi-equivalent.

<br>

> 3 - A Bayesian procedure for estimating structural and incidental parameters
jointly is feasible. The method is based on Markov-Chain Monte Carlo simulation,
and an implementation in R [@r_core_team_r:_2017] has been developed.
Despite its high computational intensiveness, it gives highly accurate results.
These results are satisfactory even under two allegedly unfavorable conditions:
without unidimensional blocks, and without blocks with different polarity
combinations (i.e., heteropolar blocks)


<div class="notes">

This model is more parsimonious than the original MUPP model.
In addition, it may be more appropriate than the original when the latent
agreement to the items in a block is a monotonical function of the trait level.

Scaling factor aside, their parameters and estimation methods are
interchangeable with negligible consequences.

</div>


---

> 4 - The new Bayesian estimation procedure outperforms the estimation method
proposed for the TIRT model, based on analysis of bivariate information through
confirmatory factor analysis [@brown_fitting_2012].
Particularly, it yields more accurate estimation errors for the incidental
parameters, a better estimation of the latent space correlational structure,
and more reasonable estimates when empirical information is scant.

<br>

> 5 - The direct bidimensional pairs (DBP) design for FC questionnaires,
intended to control for bias associated with response styles,
may suffer from an empirical underidentification we may call
*dimensional restriction*.
This condition necessarily leads to (a) a notable reduction of the reliability,
and (b) distortion of the correlations among the latent trait estimates,
in the form of negative bias.


<div class="notes">

Arguably,
the first result is due to the joint estimation of structural and incidental
parameters, the second to the use of full information, and the third to the
Bayesian features of the algorithm.

These properties are the same attributed to ipsative scores. Similar to them,
the distortion of the latent trait estimates will be worse the more positive the
actual latent dimension correlations are.

</div>


---

> 6 - A FC instrument designed under the DBP principle, although not fulfilling
the conditions for the empirical underidentification, may be close enough to it
to have identification issues. We may refer to the distance of the instrument
information matrix to the empirical underidentification as its dimensional
sensitivity.

<br>

> 7 - We have proposed cutoff criteria for the *LSV* and *LEV*, useful to assess
the property of dimensional sensitivity of an instrument.
However, neither of these indices capture all the relevant phenomena related to
the dimensional restriction of a DBP FC instrument.

<div class="notes">

This property can be quantified, and its magnitude estimated using two
proposed indices:
the least singular value (LSV), and the least eigenvalue (LEV).

Therefore, these indices should not be used for attempting to maximize the
dimensional sensitivity.

</div>


---

> 8 - The invariance assumption of the MUPP-2PL model can be tested using a nested
model comparison method.

<br>

> 9 - This method has provided evidence in favor of the invariance assumption of
the MUPP-2PL model parameters.

<br>

> 10 - The item scale estimates especially fulfill the invariance assumption.
Therefore, their predictions can be used to estimate the dimensional sensitivity
of a pairwise multidimensional FC instrument using the *LSV* and *LEV*,
attending to its item pairings.

<br>

> 11 - The violations of the invariance assumption seem to follow at least
partially predictable patterns.


<div class="notes">

We have showcased the Likelihood Ratio test applied to
the dataset of empirical responses to a FC questionnaire measuring
the Big-Five personality model.

Therefore, estimates from the graded responSe model, applied to a
graded-scale instrument made up by the individual items of the FCQ, may yield
accurate predictions of the MUPP-2PL model parameters.



Global translation and/or scaling transformations may affect the whole FC
format, while individual block parameters may deviate from their predictions due
to factors such as item dimensions or polarities.

</div>


## Limitations

Regarding the model and its applications:

- Theoretical develovments only applicable to *pairwise* responses

- Pending issues regarding robustness against *motivated distortion*

- Underidentification of the item location parameters

- Invariance assumption with DBP design


<div class="notes">

Relevant because:
This format is widely popular and is used in many instruments
Lay the foundations for future theoretical developments on other formats with
more than two items
Consider generatlizations due to connections to the TIRT and MUPP models.

DBP design not sufficient condition:
Pairing the items according to their *preference indices*
Impact of the pairing strategies on model properties
Invariance under different conditions (test only with straight-take conditions)

Major restraint for deisgn mulditidemsnional FC CATs.
Fulfilment of the invariance assumption is a necessary condition for using
pre-calibrated items.  Need to know pairing conditions to avoid.

Dimensional restriction of an instrument does not imply a distortion in the
structural parameter estimates.
If the underidentification is local to incidental parameters,
it may be possible that block parameters can be still accurately recovered.

</div>


## Limitations

Regarding the Bayesian estimation procedure:

- No model fit indices introduced

- Intensive consumption of computational resources

- Other optimization strategies

- More general modeling framework (e.g. allowing restrictions and model nesting)


## Contributions

Related to the Ph.D. project:

- Three co-authored papers (one as leading)

- Two working papers in preparation (one as leading)

- Six communications in international conferences (two as speaker)

- Five communications in national conferences and seminars (four as speaker)

- Code for simulations and MCMC estimator (more than 7,600 lines of code)

- Several posters in national and international conferences


## Contributions

Aside from Ph.D. project:

- Five co-authored papers as collaborations (one as senior)

- Seven communications in national and international conferences (one as speaker)

- Several posters in national and international conferences


## Referencias {.smaller}

